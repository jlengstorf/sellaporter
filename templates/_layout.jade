include /mixins/bem-helpers
include /mixins/miscellaneous
include /mixins/partials

doctype html
html(lang="en")

  head
    title= fields.title.rendered

    meta(charset='utf-8')

    script(src="//use.typekit.net/mdv1txb.js")
    script.
      try{Typekit.load();}catch(e){}

    link(rel="stylesheet" href="/css/main.min.css")

  body
    .sp
      -
        var isPopoverRequired = false;
      -
      each section in fields.acf.smart_sales_page
        -
          if (section.cta_type === 'popover') {
            isPopoverRequired = true;
          }
        -
        if (section.visible_phases.indexOf(fields.sellaporter_phase) !== -1)
          -
            section.current_phase = fields.sellaporter_phase;
          -
          +includeBlock(section)

      if (isPopoverRequired)
        -
          // TODO make this dynamic and figure out a better way
          var popover = {
            acf_fc_layout: 'sp-popover',
            heading_bold: fields.acf.popover_heading_bold,
            heading: fields.acf.popover_heading,
            body_text: fields.acf.popover_body_text,
            button_text: fields.acf.popover_button_text,
          };
        -
        +includeBlock(popover)

    script(src="/js/vendors.min.js")
    script(src="/js/main.min.js")

    if process.env.NODE_ENV && process.env.NODE_ENV === 'development'
      - console.warn('NOTE: Development mode is enabled!');
      script(src="//localhost:9091")
